_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[15],{"D+9z":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/relay",function(){return n("Vdi0")}])},Vdi0:function(e,t,n){"use strict";n.r(t);var r=n("cpVT"),c=n("nKUr"),i=n("xvhg"),s=n("vJKn"),a=n.n(s),o=n("rg98"),l=n("q1tI"),d=n.n(l),b=n("kEWu"),j=n.n(b),u=(n("YFqc"),n("H2TA")),h=n("R/WZ"),x=n("tRbT"),m=n("de8u"),O=n("Ji2X"),f=n("Z3vd"),g=n("Xt1q"),p=n("+Isj"),v=n("kKU3"),y=(n("Vvt1"),n("UO8e")),w=n("wDBh"),S=n("Y5ta"),N=S.SecretNetworkClient,k=(S.MetaMaskWallet,"89"),C="12",T=10,P=10,A=Object(h.a)((function(e){return{green:{backgroundColor:"rgb(33 182 111)",color:"#ffffff"},purple:{backgroundColor:"rgb(124 58 237)",color:"#ffffff"},red:{backgroundColor:"rgb(255 56 86)",color:"#ffffff"},blue:{backgroundColor:"#384aff",color:"#ffffff"},boxStyle:{borderColor:"#444444",borderWidth:"1px",borderStyle:"solid",borderRadius:"20px",margin:"1em 0"},addPadding:{padding:"1em"},listHolder:{borderColor:"#444444",borderWidth:"1px",borderStyle:"solid",borderRadius:"20px",margin:"1em 0",padding:e.spacing(3),display:"flex"},listContent:{width:"100%",display:"inline-block"},listBadge:{width:"auto",paddingRight:"1em",display:"inline-block"},listTitle:{fontSize:"2em",fontWeight:"bold",marginTop:0,marginBottom:0,display:"block"},listVoteCount:{fontSize:"1.5em",fontWeight:"bold",marginTop:"1em"},voteScore:{display:"block",marginTop:"1em"},main:{width:"100%",margin:"20px auto"},text:{},btn:{background:"rgb(183,192,238)",cursor:"pointer",border:0,outline:"none",borderRadius:9999,height:50,display:"inline-block",alignItems:"center",fontSize:"1.5em"},buttonNew:{borderColor:"rgb(33 182 111)",borderWidth:"1px",borderStyle:"solid",borderRadius:10,textTransform:"none",boxShadow:"none",minWidth:"220px"},buttonNewGreen:{borderColor:"rgb(33 182 111)",borderWidth:"1px",borderStyle:"solid",borderRadius:10,textTransform:"none",boxShadow:"none",minWidth:"220px"},buttonVote:{borderColor:"#666666",borderWidth:"1px",borderStyle:"solid",marginLeft:"1em",textTransform:"none"},img:{borderRadius:999,marginRight:5},root:{width:"100%"},inline:{display:"inline"},avatar:{marginRight:"15px"},item:{padding:e.spacing(2),marginBottom:"20px",backgroundColor:"#333333"},heroSpace:{textAlign:"center",marginTop:"1em",marginBottom:"1em"},modal:{display:"flex",alignItems:"center",justifyContent:"center"},paperModal:{backgroundColor:"rgb(124 58 237)",color:"#ffffff",textAlign:"center",border:"2px solid #000",borderRadius:"20px",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}));t.default=function(){var e,t,n=A(),s=Object(l.useState)(""),b=s[0],h=s[1],S=Object(l.useState)(""),R=S[0],E=S[1],D=Object(l.useState)(0),W=(D[0],D[1]),V=Object(l.useState)(0),B=V[0],I=V[1],_=Object(l.useState)(0),M=_[0],q=_[1],U=Object(l.useState)(0),z=U[0],Y=U[1],H=Object(l.useState)(0),J=H[0],L=H[1],K=Object(l.useState)(),X=K[0],F=K[1],G=Object(l.useState)(!1),Q=(G[0],G[1]),Z=Object(l.useState)(""),$=Z[0],ee=Z[1],te=Object(l.useState)(""),ne=te[0],re=te[1],ce=Object(l.useState)(""),ie=(ce[0],ce[1]),se=Object(l.useState)(!1),ae=se[0],oe=se[1],le=Object(l.useState)(""),de=le[0],be=le[1],je=Object(l.useState)(""),ue=je[0],he=je[1],xe=Object(l.useState)(void 0),me=(xe[0],xe[1]),Oe=Object(l.useState)("Secret Ballot Dao Voting For Ethereum Users"),fe=(Oe[0],Oe[1],Object(l.useState)(!1)),ge=fe[0],pe=fe[1],ve=Object(l.useState)(!1),ye=(ve[0],ve[1],function(){var e=Object(o.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"http://localhost:8080/addwhitelist/",fetch("http://localhost:8080/addwhitelist/",{method:"POST",headers:{"Content-Type":"application/json"},body:t}).then((function(e){return e.json()})).then((function(e){Ne(e),pe(!0)})).catch((function(e){console.log(e)})).finally((function(){console.log("FINALLY")}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),we=function(){var e=Object(o.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X.tx.compute.executeContract({sender:b,contractAddress:y.h,msg:{increment:{}}},{gasLimit:5e5});case 3:return t=e.sent,console.log(t.transactionHash),e.next=7,X.query.compute.queryContract({contractAddress:y.h,query:{get_count:{}}});case 7:n=e.sent,r=n.count,W(r),ke(r),Ee(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}(),Se=function(e){return e.slice(0,8)+"..."+e.slice(-3)},Ne=function(e){console.log(e.voteResult.ethAddy),ee(e.voteResult.ethAddy),re(e.voteResult.votingTokenBal),ie(e.voteResult.secretWhitelistTx)},ke=function(e){function t(e,t){return Math.round(e/t*100)}var n=T+e,r=n+P;I(n),q(P),Y(t(n,r)),L(t(P,r))},Ce=Object(u.a)((function(e){return{root:{height:15,borderRadius:5},colorPrimary:{backgroundColor:e.palette.grey["dark"===e.palette.type?200:700]},bar:{borderRadius:5,backgroundColor:"#384aff"}}}))(m.a),Te=d.a.useState(!1),Pe=Object(i.a)(Te,2),Ae=Pe[0],Re=Pe[1],Ee=function(){Re(!0)},De=function(){var e=Object(o.a)(a.a.mark((function e(){var t,n,r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new w.a.providers.Web3Provider(window.ethereum),e.next=3,t.send("eth_requestAccounts",[]);case 3:return n=e.sent,e.next=6,t.getBalance(n[0]);case 6:r=e.sent,c=w.a.utils.formatEther(r),oe(!0),he(c),be(n[0]),me(t);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),We=function(){var e=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("disconnectEthers"),oe(!1);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ve=function(){var e=Object(o.a)(a.a.mark((function e(){var t,n,r,c,i,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={ethAddy:de,srtAddy:b,propId:C,votingTokenBal:k},n=JSON.stringify(t),r=new w.a.providers.Web3Provider(window.ethereum),c=r.getSigner(),e.next=6,c.signMessage(n);case 6:return i=e.sent,t.signature=i,s=JSON.stringify(t),ye(s),e.next=12,w.a.utils.verifyMessage(n,i);case 12:e.sent;case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.useEffect)((function(){var e=function(e){return new Promise((function(t){return setTimeout(t,e)}))};return function(){var t=Object(o.a)(a.a.mark((function t(){var n,r,c,s,o,l,d,b,j;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(window.keplr||window.getOfflineSigner||window.getEnigmaUtils){t.next=5;break}return t.next=3,e(10);case 3:t.next=0;break;case 5:return t.next=7,window.keplr.experimentalSuggestChain({chainId:y.a,chainName:y.b,rpc:y.g,rest:y.e,bip44:{coinType:529},coinType:529,stakeCurrency:{coinDenom:y.c,coinMinimalDenom:y.f,coinDecimals:6},bech32Config:{bech32PrefixAccAddr:"secret",bech32PrefixAccPub:"secretpub",bech32PrefixValAddr:"secretvaloper",bech32PrefixValPub:"secretvaloperpub",bech32PrefixConsAddr:"secretvalcons",bech32PrefixConsPub:"secretvalconspub"},currencies:[{coinDenom:y.c,coinMinimalDenom:y.f,coinDecimals:6}],feeCurrencies:[{coinDenom:y.c,coinMinimalDenom:y.f,coinDecimals:6}],gasPriceStep:{low:.1,average:.25,high:.4},features:["secretwasm"]});case 7:return t.next=9,window.keplr.enable(y.a);case 9:return n=window.getOfflineSignerOnlyAmino(y.a),t.next=12,n.getAccounts();case 12:return r=t.sent,c=Object(i.a)(r,1),s=c[0].address,t.next=17,N.create({grpcWebUrl:y.d,chainId:y.a,wallet:n,walletAddress:s,encryptionUtils:window.getEnigmaUtils(y.a)});case 17:return o=t.sent,t.next=20,o.query.compute.queryContract({contractAddress:y.h,query:{get_count:{}}});case 20:return l=t.sent,d=l.count,t.next=24,o.query.bank.balance({address:s,denom:"uscrt"});case 24:b=t.sent,j=b.balance,ke(d),W(d),E(j.amount),Q(!0),h(s),F(o);case 32:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()(),function(){}}),[]),Object(c.jsxs)("main",{className:n.main,children:[Object(c.jsxs)(O.a,{maxwidth:"lg",children:[Object(c.jsx)(x.a,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",className:n.heroSpace,children:Object(c.jsx)(x.a,{item:!0,xs:12,children:Object(c.jsx)("h2",{children:"Secret Voting on Ethereum Technical Demo. Testnet Required."})})}),Object(c.jsxs)(x.a,{container:!0,spacing:2,direction:"row",justifyContent:"space-between",alignItems:"stretch",children:[Object(c.jsx)(x.a,{item:!0,xs:12,sm:4,className:n.boxStyle,children:Object(c.jsxs)("div",{className:"addPadding",children:[Object(c.jsx)("h1",{children:"Secret Side"}),Object(c.jsx)("div",{children:Object(c.jsx)(f.a,{variant:"contained",color:"primary",size:"medium",className:b?n.buttonNewGreen:n.buttonNew,startIcon:Object(c.jsx)(j.a,{className:n.img,seed:b.toLowerCase(),size:6,scale:3}),children:b?Se(b):"Connect Keplr"})}),Object(c.jsxs)("div",{className:"metricsPanel",children:[Object(c.jsx)("div",{children:Object(c.jsx)("strong",{children:"Data from Ethereum"})}),Object(c.jsxs)("div",{className:"greenText",children:[Object(c.jsx)("strong",{children:"ETH addy:"})," ",Se($)]}),Object(c.jsxs)("div",{className:"greenText",children:[Object(c.jsx)("strong",{children:"Voting Weight:"})," ",ne]}),Object(c.jsxs)("p",{className:"voteButtons",children:[Object(c.jsx)("div",{children:Object(c.jsx)("strong",{children:"Actions"})}),Object(c.jsx)(f.a,{variant:"outlined",color:"secondary",onClick:Ve,className:ge?"":"btnDisabled",children:"New Proposal"})]}),Object(c.jsxs)("p",{children:[Object(c.jsx)("div",{children:Object(c.jsx)("strong",{children:"Secret Info"})}),Object(c.jsxs)("div",{className:"greenText",children:[Object(c.jsx)("strong",{children:"Secret Bal:"})," ",R]})]}),Object(c.jsxs)("p",{children:[Object(c.jsx)("div",{children:Object(c.jsx)("strong",{children:"Vote Secretly"})}),Object(c.jsxs)("div",{className:"voteButtons",children:[Object(c.jsx)(f.a,{variant:"outlined",className:ge?"":"btnDisabled",style:{borderColor:"#fff"},onClick:we,children:"Yes"}),Object(c.jsx)(f.a,(e={variant:"contained"},Object(r.a)(e,"variant","outlined"),Object(r.a)(e,"className",ge?"":"btnDisabled"),Object(r.a)(e,"style",{borderColor:"#fff"}),Object(r.a)(e,"onClick",we),Object(r.a)(e,"children","No"),e))]})]})]}),Object(c.jsxs)("div",{className:n.voteScore,children:[Object(c.jsxs)("div",{children:["Yes: ",B]}),Object(c.jsx)(Ce,{variant:"determinate",value:z}),Object(c.jsx)("br",{}),Object(c.jsxs)("div",{children:["No: ",M]}),Object(c.jsx)(Ce,{variant:"determinate",value:J})]})]})}),Object(c.jsx)(x.a,{item:!0,xs:12,sm:3,alignItems:"center",style:{display:"flex",justifyContent:"flex-start"},children:Object(c.jsxs)("div",{className:"addPadding",children:[Object(c.jsx)("h2",{children:"Relayer Task 1"}),Object(c.jsx)("div",{className:ge?"":"btnDisabled",children:Object(c.jsxs)("ul",{className:"no-bullets greenText",children:[Object(c.jsx)("li",{children:"Verifying ETH address"}),Object(c.jsx)("li",{children:"Querying ETH token val"}),Object(c.jsx)("li",{children:"Connecting to Secret"}),Object(c.jsx)("li",{children:"Submiting voter data"}),Object(c.jsx)("li",{children:"Voter added"})]})})]})}),Object(c.jsx)(x.a,{item:!0,xs:12,sm:4,className:n.boxStyle,children:Object(c.jsxs)("div",{className:"addPadding",children:[Object(c.jsx)("h1",{children:"Ethereum Side"}),Object(c.jsx)("div",{children:Object(c.jsx)(f.a,{variant:"contained",color:"primary",size:"medium",className:ae?n.buttonNewGreen:n.buttonNew,onClick:ae?We:De,startIcon:Object(c.jsx)(j.a,{className:n.img,seed:de,size:6,scale:3}),children:ae?Se(de):"Connect MetaMask"})}),Object(c.jsxs)("div",{className:"metricsPanel",children:[Object(c.jsx)("div",{children:Object(c.jsx)("strong",{children:"Ethereum Info"})}),Object(c.jsxs)("div",{className:"greenText",children:[Object(c.jsx)("strong",{children:"My Eth Bal:"})," ",ue]}),Object(c.jsxs)("div",{className:"greenText",children:[Object(c.jsx)("strong",{children:"Voting Token Balance:"})," ",ae?k:""]}),Object(c.jsxs)("p",{className:"voteButtons",children:[Object(c.jsx)("div",{children:Object(c.jsx)("strong",{children:"Actions"})}),Object(c.jsx)(f.a,{variant:"outlined",color:"secondary",onClick:Ve,className:ae?"":"btnDisabled",children:"Whitelist User"})]})]}),Object(c.jsxs)("div",{className:n.voteScore,children:[Object(c.jsxs)("div",{children:["Yes: ",B]}),Object(c.jsx)(Ce,{variant:"determinate",value:z}),Object(c.jsx)("br",{}),Object(c.jsxs)("div",{children:["No: ",M]}),Object(c.jsx)(Ce,{variant:"determinate",value:J})]})]})}),Object(c.jsx)(x.a,(t={container:!0,spacing:1,maxWidth:"lg",className:n.boxStyle},Object(r.a)(t,"container",!0),Object(r.a)(t,"direction","row"),Object(r.a)(t,"justifyContent","center"),Object(r.a)(t,"alignItems","center"),Object(r.a)(t,"style",{display:"none"}),Object(r.a)(t,"children",Object(c.jsxs)(x.a,{container:!0,item:!0,xs:12,spacing:3,children:[Object(c.jsx)(x.a,{item:!0,xs:4,children:Object(c.jsxs)("div",{className:"addPadding",children:[Object(c.jsx)("h2",{children:"Relayer Task 1"}),Object(c.jsx)("div",{className:ge?"":"btnDisabled",children:Object(c.jsxs)("ul",{className:"no-bullets greenText",children:[Object(c.jsx)("li",{children:"Verifying ETH address"}),Object(c.jsx)("li",{children:"Querying voting token val from ETH"}),Object(c.jsx)("li",{children:"Connecting to Secret"}),Object(c.jsx)("li",{children:"Submiting voter data"}),Object(c.jsx)("li",{children:"Voter added"})]})})]})}),Object(c.jsx)(x.a,{item:!0,xs:4}),Object(c.jsx)(x.a,{item:!0,xs:4,children:Object(c.jsxs)("div",{className:"addPadding hidden",children:[Object(c.jsx)("h2",{children:"Relayer Util"}),Object(c.jsx)("div",{children:Object(c.jsx)("button",{onClick:we,children:"Increment"})}),Object(c.jsx)("div",{children:Object(c.jsx)("button",{onClick:Ve,children:"signEthTx / callRelayWhitelist"})}),Object(c.jsx)("div",{children:Object(c.jsx)("button",{onClick:ye,children:"callRelayWhitelist"})})]})})]})),t))]})]}),Object(c.jsx)(g.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:n.modal,open:Ae,onClose:function(){Re(!1)},closeAfterTransition:!0,BackdropComponent:p.a,BackdropProps:{timeout:500},children:Object(c.jsx)(v.a,{in:Ae,children:Object(c.jsx)("div",{className:n.paperModal,children:Object(c.jsxs)("h1",{id:"transition-modal-title",children:["YAY!",Object(c.jsx)("br",{}),"You Voted Secretly!"]})})})})]})}},cpVT:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return r}))}},[["D+9z",0,2,6,1,3,4,5]]]);